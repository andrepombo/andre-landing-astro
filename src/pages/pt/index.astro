---
import Base from '../../layouts/Base.astro';
import Hero from '../../components/Hero.astro';
import Projects from '../../components/Projects.astro';
import Articles from '../../components/Articles.astro';
import Footer from '../../components/Footer.astro';
import SocialIcons from '../../components/SocialIcons.tsx';
import { getCollection } from 'astro:content';

const lang: 'en' | 'pt' = 'pt';
const toggleUrl = '/';

const meta = {
  name: 'André Pombo',
  headline: 'Criando Experiências Digitais',
  subhead: 'Desenvolvedor full‑stack do Brasil. Eu projeto, construo e entrego aplicativos em produção de ponta a ponta — da arquitetura de backend e UX de frontend ao CI/CD e à infraestrutura em nuvem.',
  avatar: 'https://images.unsplash.com/photo-1502685104226-ee32379fefbe?q=80&w=600&auto=format&fit=crop',
  badges: ['Python', 'Django', 'React', 'DevOps', 'CI/CD', 'AWS'],
  cta: { label: 'andrebastos85@gmail.com', href: 'mailto:andrebastos85@gmail.com' },
  links: { github: 'https://github.com/andrepombo', x: 'https://x.com/', linkedin: 'https://www.linkedin.com/', medium: 'https://medium.com/' }
};

// Load content collections
const projectCollection = await getCollection('projects');
const projectFiles = projectCollection.map((project) => ({
  url: `/pt/projects/${project.slug}`,
  frontmatter: {
    title: project.data.title,
    description: project.data.description,
    image: project.data.image,
    href: project.data.href ?? '',
    tags: project.data.tags,
    highlight: project.data.highlight
  }
}));
const articleCollection = await getCollection('articles');
const articleFiles = articleCollection.map((article) => ({
  url: `/pt/articles/${article.slug}`,
  frontmatter: {
    title: article.data.title,
    description: article.data.description,
    image: article.data.image,
    href: article.data.href ?? '',
    tags: article.data.tags,
    date: article.data.date
  }
}));
---
<Base title="Developer Portfolio" description="Projects and articles" lang={lang}>
  <Hero meta={meta} lang={lang} toggleUrl={toggleUrl} />
  <Projects items={projectFiles} lang={lang} />
  <Articles items={articleFiles} lang={lang} />
  <section id="contact" class="max-w-6xl mx-auto px-4 sm:px-6 py-12 sm:py-20">
    <div class="rounded-2xl border border-slate-200 dark:border-slate-800 p-6 sm:p-10 bg-gradient-to-br from-[--color-accent-50] to-white dark:from-slate-900 dark:to-slate-950">
      <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-6">
        <div>
          <h2 class="text-2xl font-semibold tracking-tight">Vamos construir algo incrível</h2>
          <p class="text-sm text-slate-600 dark:text-slate-300">Estou aberto a consultoria, colaboração e oportunidades onde eu possa gerar impacto.</p>
        </div>
        <div class="flex flex-col sm:flex-row items-start sm:items-center gap-3">
          <SocialIcons client:load github={meta.links.github} linkedin={meta.links.linkedin} />
          <a href={meta.cta.href} class="flex items-center gap-2 px-4 py-2 rounded-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 hover:border-gray-900 dark:hover:border-white hover:bg-gray-900 dark:hover:bg-white hover:text-white dark:hover:text-gray-900 text-gray-600 dark:text-gray-400 transition-all w-full sm:w-auto">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <rect width="20" height="16" x="2" y="4" rx="2" />
              <path d="m22 7-8.97 5.7a2 2 0 0 1-2.06 0L2 7" />
            </svg>
            <span class="break-all sm:break-keep">{meta.cta.label}</span>
          </a>
        </div>
      </div>
    </div>
  </section>
  <Footer links={meta.links} />
</Base>
